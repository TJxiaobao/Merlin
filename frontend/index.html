<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🧙 Merlin - AI表格填充助手</title>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧙 Merlin</h1>
            <p>AI表格填充助手 - 用自然语言操作Excel</p>
        </div>

        <div class="main-card">
            <!-- 左侧边栏 -->
            <div class="sidebar">
                <!-- 文件上传区 -->
                <div class="file-upload-section">
                    <div class="file-upload-area" id="dropZone">
                        <div class="upload-icon">📁</div>
                        <div class="upload-text">点击或拖拽上传</div>
                        <div class="upload-hint">支持 .xlsx 格式</div>
                        <input type="file" id="fileInput" accept=".xlsx">
                    </div>

                    <!-- 文件信息卡片 -->
                    <div class="file-info" id="fileInfo">
                        <div class="file-info-header">
                            <div class="file-info-title" id="fileName"></div>
                            <button class="file-info-close" id="closeFile">×</button>
                        </div>
                        <div class="file-info-stats">
                            📊 <strong>总行数:</strong> <span id="totalRows"></span><br>
                            📋 <strong>总列数:</strong> <span id="totalColumns"></span>
                        </div>
                        <div class="columns-section">
                            <div class="columns-section-title">📝 列名列表:</div>
                            <div class="columns-list" id="columnsList"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 右侧聊天区域 -->
            <div class="chat-section">
                <div class="messages-container" id="messagesContainer">
                    <div class="welcome-message" id="welcomeMessage">
                        <h2>👋 欢迎使用 Merlin</h2>
                        <p>请先上传一个 Excel 文件，然后用自然语言告诉我你想做什么</p>
                        
                        <div class="welcome-examples">
                            <h3>💡 示例指令：</h3>
                            <div class="example" onclick="fillExample('把所有税率设为0.13')">
                                "把所有税率设为0.13"
                            </div>
                            <div class="example" onclick="fillExample('把Gateway的价格设为100')">
                                "把Gateway的价格设为100"
                            </div>
                            <div class="example" onclick="fillExample('统计设备类型的分布')">
                                "统计设备类型的分布" ⭐️ 新增
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 输入区域 -->
                <div class="input-section">
                    <div class="input-container">
                        <button class="magic-wand-btn" id="magicWandBtn" disabled title="查看功能示例">✨</button>
                        <textarea 
                            id="commandInput" 
                            placeholder="请先上传Excel文件..." 
                            rows="1"
                            disabled
                        ></textarea>
                        <button class="btn btn-primary" id="sendBtn" disabled>
                            <span id="sendBtnText">发送</span>
                        </button>
                    </div>
                    <div class="action-buttons" id="actionButtons" style="display: none;">
                        <button class="download-btn" id="downloadBtn" style="display: none;">
                            📥 下载修改后的文件
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 功能示例模态框 -->
    <div class="modal-overlay" id="featureModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">✨ Merlin 魔法指令</h2>
                <button class="modal-close" id="modalClose">×</button>
            </div>

            <div class="feature-category">
                <h3 class="category-title">📝 数据填充与修改</h3>
                <div class="feature-example" data-command="把所有税率设为0.13">
                    <span class="feature-example-text">把所有税率设为0.13</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="把设备类型是Gateway的未税单价设为100">
                    <span class="feature-example-text">把设备类型是Gateway的未税单价设为100</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="把设备编码为196001的价格设为100，196002的设为200">
                    <span class="feature-example-text">把设备编码为196001的价格设为100，196002的设为200</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
            </div>

            <div class="feature-category">
                <h3 class="category-title">🧮 数学计算 <span style="color: #f56565; font-size: 0.8em;">⭐️ v0.0.2</span></h3>
                <div class="feature-example" data-command="让总价等于数量乘以单价">
                    <span class="feature-example-text">让总价等于数量乘以单价</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="计算利润等于售价减去成本价">
                    <span class="feature-example-text">计算利润等于售价减去成本价</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="把未税单价乘以1.13存入含税单价，保留2位小数">
                    <span class="feature-example-text">把未税单价乘以1.13存入含税单价，保留2位小数</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
            </div>

            <div class="feature-category">
                <h3 class="category-title">🧹 数据清洗 <span style="color: #f56565; font-size: 0.8em;">⭐️ v0.0.2</span></h3>
                <div class="feature-example" data-command="清理设备名称列的空格">
                    <span class="feature-example-text">清理设备名称列的空格</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="把备注列的空白单元格填充为N/A">
                    <span class="feature-example-text">把备注列的空白单元格填充为N/A</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="把客户区域列里的北京都替换成华北区">
                    <span class="feature-example-text">把客户区域列里的北京都替换成华北区</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
            </div>

            <div class="feature-category">
                <h3 class="category-title">📊 统计分析</h3>
                <div class="feature-example" data-command="统计设备类型的分布">
                    <span class="feature-example-text">统计设备类型的分布</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="帮我看看设备编码有哪些">
                    <span class="feature-example-text">帮我看看设备编码有哪些</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="按设备类型分组，计算未税单价的平均值">
                    <span class="feature-example-text">按设备类型分组，计算未税单价的平均值</span>
                    <span class="feature-example-hint">⭐️ v0.0.4 新增</span>
                </div>
            </div>

            <div class="feature-category">
                <h3 class="category-title">✏️ 文本处理 <span style="color: #f56565; font-size: 0.8em;">⭐️ v0.0.4</span></h3>
                <div class="feature-example" data-command="把姓和名合并为全名，用空格连接">
                    <span class="feature-example-text">把姓和名合并为全名，用空格连接</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="把客户信息列按'-'拆分">
                    <span class="feature-example-text">把客户信息列按'-'拆分</span>
                    <span class="feature-example-hint">⭐️ v0.0.4-beta</span>
                </div>
                <div class="feature-example" data-command="把产品编码列全部转为大写">
                    <span class="feature-example-text">把产品编码列全部转为大写</span>
                    <span class="feature-example-hint">⭐️ v0.0.4-beta</span>
                </div>
            </div>

            <div class="feature-category">
                <h3 class="category-title">📅 日期工具 <span style="color: #f56565; font-size: 0.8em;">⭐️ v0.0.4</span></h3>
                <div class="feature-example" data-command="从订单日期提取月份">
                    <span class="feature-example-text">从订单日期提取月份</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="从创建时间提取年份">
                    <span class="feature-example-text">从创建时间提取年份</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="提取生日的星期几">
                    <span class="feature-example-text">提取生日的星期几</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
            </div>

            <div class="feature-category">
                <h3 class="category-title">🏗️ 表格结构 <span style="color: #f56565; font-size: 0.8em;">⭐️ v0.0.4-beta</span></h3>
                <div class="feature-example" data-command="删除重复行">
                    <span class="feature-example-text">删除重复行</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="根据客户邮箱列删除重复数据">
                    <span class="feature-example-text">根据客户邮箱列删除重复数据</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="按销售额列降序排序">
                    <span class="feature-example-text">按销售额列降序排序</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
                <div class="feature-example" data-command="把表格按日期升序排列">
                    <span class="feature-example-text">把表格按日期升序排列</span>
                    <span class="feature-example-hint">点击填充</span>
                </div>
            </div>

            <div class="modal-footer">
                💡 提示：点击任一示例自动填入聊天框，记得把列名替换成你表格里的实际列名哦！
            </div>
        </div>
    </div>

    <script type="module" src="/main.js"></script>
</body>
</html>

